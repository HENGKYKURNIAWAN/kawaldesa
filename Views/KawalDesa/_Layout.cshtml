<html lang="en" ng-app="kawaldesa" data-framework="angularjs" style="min-height: 100%;">
<head>
    <!-- facebook hash remover -->
    <script type="text/javascript">if (window.location.hash == '#_=_') window.location.hash = '';</script>

    <script type="text/javascript">window.CurrentUser = @Html.Raw(ViewData["User"]);</script>

    <title>Kawal Desa - Transparansi Alokasi, Penyaluran dan Realisasi Dana Desa</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">

    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic' />

    @Styles.Render("~/css/kawaldesa-all")
    @Scripts.Render("~/js/kawaldesa-lib")
    @Scripts.Render("~/js/kawaldesa-own")

</head>
<body ng-controller="IndexCtrl as indexCtrl" ng-cloak class="ng-cloak" style="min-height: 100%;">
    <header role="banner" id="top" class="navbar navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button style="color: #337ab7;" data-target="#bs-navbar" data-toggle="collapse" type="button" class="navbar-toggle collapsed">
                    <span class="sr-only">Toggle navigation</span>
                    <span style="background-color: #337ab7;" class="icon-bar"></span>
                    <span style="background-color: #337ab7;" class="icon-bar"></span>
                    <span style="background-color: #337ab7;" class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/" style=" padding-left 20px; margin-right: 10px; background-color: #337ab7; color: #fff;">KD</a>
            </div>
            <nav class="collapse navbar-collapse">
                <ul class="nav navbar-nav nav-menu">
                    <li class="dropdown" ng-class="{'active' : indexCtrl.type == 'dd' || indexCtrl.type == 'add' || indexCtrl.type == 'bhpr', 'open' : navOpen}">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#" ng-click="navOpen = !navOpen; $event.stopPropagation();">
                            Alokasi
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li ng-class="{'active': indexCtrl.type == 'dd'}"><a href="/dd/{{indexCtrl.region.Type == 4 ? indexCtrl.region.fkParentId : indexCtrl.regionId}}" ng-click="navOpen = false;indexCtrl.changeType('dd', $event)">DD dari APBN</a></li>
                            <li ng-class="{'active': indexCtrl.type == 'add'}"><a href="/add/{{indexCtrl.region.Type == 4 ? indexCtrl.region.fkParentId : indexCtrl.regionId}}" ng-click="navOpen = false;indexCtrl.changeType('add', $event)">ADD dari APBD</a></li>
                            <li ng-class="{'active': indexCtrl.type == 'bhpr'}"><a href="/bhpr/{{indexCtrl.region.Type == 4 ? indexCtrl.region.fkParentId : indexCtrl.regionId}}" ng-click="navOpen = false;indexCtrl.changeType('bhpr', $event)">Bagi Hasil PDRD</a></li>
                        </ul>
                    </li>
                    <li ng-class="{'active' : indexCtrl.type == 'transfer'}">
                        <a href="/p/{{indexCtrl.regionId}}" ng-click="indexCtrl.changeType('transfer', $event)">Penyaluran</a>
                    </li>
                    <!--
                    <li ng-class="{'active' : indexCtrl.type == 'realization'}">
                        <a href="/r/{{indexCtrl.regionId}}" ng-click="indexCtrl.changeType('realization', $event)">Realisasi</a>
                    </li>
                    -->
                </ul>
                <ul class="nav navbar-nav nav-region" ng-show="!searchShown">

                    <li ng-if="!$first" ng-repeat-start="region in indexCtrl.regionTree">
                        <div class="gt hidden-xs">→</div>
                    </li>
                    <li ng-repeat-end ng-class="{'active':$last}">
                        <a href="#" ng-click="indexCtrl.changeRegion(region.Id, $event)">
                            {{region.Name}}
                        </a>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li ng-show="!searchShown">
                        <a href="#" class="btn" ng-click="indexCtrl.showSearch($event)"> <i class="fa fa-search" style="line-height: 20px;"></i></a>
                    </li>
                    <li class="dropdown" ng-class="{'active' : indexCtrl.type == 'dashboard', 'open': navUserOpen}" ng-if="indexCtrl.currentUser">
                        <a ng-click="navUserOpen = !navUserOpen; $event.stopPropagation();"style="padding-right: 20px;" href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <img ng-src='http://graph.facebook.com/v2.2/{{indexCtrl.currentUser.FacebookId}}/picture' style="width: 20px; height: 20px; margin-right: 5px;" />
                            {{indexCtrl.currentUser.Name}}
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li ng-class="{'active': indexCtrl.type == 'users'}">
                                <a ng-click="navUserOpen = false;" href="/u/{{indexCtrl.currentUser.Id}}"><i style="width: 20px;" class="fa fa-user"></i> Profil</a>
                            </li>
                            <li ng-click="navUserOpen = false;" ng-class="{'active': indexCtrl.type == 'orgs'}" ng-show="{{indexCtrl.currentUser.fkOrganizationId}}">
                                <a href="/orgs/{{indexCtrl.currentUser.fkOrganizationId}}"><i style="width: 20px;" class="fa fa-users"></i> Organisasi</a>
                            </li>
                            <li><a ng-click="navUserOpen = false;" href="/logout"><i style="width: 20px;" class="fa fa-sign-out"></i> Logout</a></li>
                        </ul>
                    </li>
                    <li><a style="padding-right: 20px;" href="/login" ng-if="!indexCtrl.currentUser">Login</a></li>
                </ul>
                <script type="text/ng-template" id="searchTemplate.html">
                    <a style="text-transform:uppercase;">
                        <div class="pull-left">
                            <span style="color: #999">{{match.model.TypeName}}</span> <span ng-bind-html="match.model.Name | typeaheadHighlight:query"></span>
                        </div>
                        <div ng-if="match.model.Parent" class="pull-right">
                            <small style="margin-left: 20px; font-size: 65%; line-height: 20px;">{{match.model.Parent}}</small>
                        </div>
                        <div style="clear: both;"></div>
                    </a>
                </script>
                <script type="text/ng-template" id="template/typeahead/typeahead-match.html">
                    <a href tabindex="-1" ng-bind-html="match.label | typeaheadHighlight:query"></a>
                </script>
                <script type="text/ng-template" id="template/typeahead/typeahead-popup.html">
                    <ul class="dropdown-menu" ng-show="isOpen() && !moveInProgress" ng-style="{top: position().top+'px', left: position().left+'px'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">
                        <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{::match.id}}">
                            <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>
                        </li>
                    </ul>
                </script>
                <form class="navbar-form navbar-right" role="search" ng-show="searchShown" style="border-left: 1px solid #ccc; border-right: 1px solid #ccc;">
                    <div class="input-group search-input-group" style="width: 375px;">
                        <input type="text" ng-model="selectedSearch" placeholder="Cari desa, kecamatan, kabupaten, atau propinsi"
                               typeahead="region as region.Name for region in indexCtrl.searchRegions($viewValue)" typeahead-template-url="searchTemplate.html" class="form-control" typeahead-on-select="indexCtrl.onSearchSelected($item, $model, $value)">
                        <div class="input-group-btn" style="width: 1%;">
                            <button class="btn btn-primary" type="submit"><span class="fa fa-search"></span>&nbsp;</button>
                        </div>
                    </div>
                    <a href="#" style="margin: 0 0 0 1em;" ng-click="searchShown=false; $event.preventDefault();"><i class="fa fa-times"></i></a>
                </form>
            </nav>
        </div>
    </header>
    @RenderBody()
    <footer>
        <nav class="navbar navbar-default navbar-bottom" role="navigation">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-12">
                        <p>
                            Source code kawaldesa.org ada di <a href="http://www.github.com/ghk/kawaldesa">github</a>
                        </p>
                    </div>
                </div>
            </div>
        </nav>

    </footer>

</body>
</html>
<script type="text/ng-template" id="template/modal/backdrop.html">
    <div class="modal-backdrop"
         modal-animation-class="fade"
         modal-in-class="in"
         ng-style="{'z-index': 1040 + (index && 1 || 0) + index*10}">
    </div>
</script>

<script type="text/ng-template" id="template/modal/window.html">
    <div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal"
         modal-animation-class="fade"
         modal-in-class="in"
         ng-style="{'z-index': 1050 + index*10, display: 'block'}" ng-click="close($event)">
        <div class="modal-dialog" ng-class="size ? 'modal-' + size : ''"><div class="modal-content" modal-transclude></div></div>
    </div>
</script>
